# Домашнее задание к занятию «Репликация и масштабирование. Часть 2»

### Инструкция по выполнению домашнего задания

1. Сделайте fork [репозитория c шаблоном решения](https://github.com/netology-code/sys-pattern-homework) к себе в Github и переименуйте его по названию или номеру занятия, например, https://github.com/имя-вашего-репозитория/gitlab-hw или https://github.com/имя-вашего-репозитория/8-03-hw).
2. Выполните клонирование этого репозитория к себе на ПК с помощью команды `git clone`.
3. Выполните домашнее задание и заполните у себя локально этот файл README.md:
   - впишите вверху название занятия и ваши фамилию и имя;
   - в каждом задании добавьте решение в требуемом виде: текст/код/скриншоты/ссылка;
   - для корректного добавления скриншотов воспользуйтесь инструкцией [«Как вставить скриншот в шаблон с решением»](https://github.com/netology-code/sys-pattern-homework/blob/main/screen-instruction.md);
   - при оформлении используйте возможности языка разметки md. Коротко об этом можно посмотреть в [инструкции по MarkDown](https://github.com/netology-code/sys-pattern-homework/blob/main/md-instruction.md).
4. После завершения работы над домашним заданием сделайте коммит (`git commit -m "comment"`) и отправьте его на Github (`git push origin`).
5. Для проверки домашнего задания преподавателем в личном кабинете прикрепите и отправьте ссылку на решение в виде md-файла в вашем Github.
6. Любые вопросы задавайте в чате учебной группы и/или в разделе «Вопросы по заданию» в личном кабинете.

Желаем успехов в выполнении домашнего задания.

---

### Задание 1

Опишите основные преимущества использования масштабирования методами:

- активный master-сервер и пассивный репликационный slave-сервер; 
- master-сервер и несколько slave-серверов;


*Дайте ответ в свободной форме.*

Преимущества использования разных схем масштабирования:
 1. Активный master-сервер и пассивный репликационный slave-сервер
 - Master принимает все запросы на запись, slave — резервная копия.
 - Преимущества:
   Высокая отказоустойчивость: если master упадёт, slave можно быстро перевести в master.
 - Защита данных: изменения реплицируются, минимизируется риск потери.
 - Простота администрирования: система относительно проста в управлении.
 - Минус: нагрузка на master не распределяется, slave простаивает большую часть времени.
 2. Master-сервер и несколько slave-серверов
 - Master выполняет все записи, а чтение распределяется между несколькими slave.
- Преимущества:
   Балансировка нагрузки: запросы на чтение уходят на slave, что разгружает master.
 - Масштабируемость: можно добавлять новые slave по мере роста нагрузки.
 - Отказоустойчивость: при сбое одного из slave система продолжает работать.
 - Гибкость: можно использовать slave для аналитики или бэкапов, не мешая master.
 - Минус: задержка репликации — возможны расхождения между master и slave (особенно при большом объёме данных).
---

### Задание 2


Разработайте план для выполнения горизонтального и вертикального шаринга базы данных. База данных состоит из трёх таблиц: 

- пользователи, 
- книги, 
- магазины (столбцы произвольно). 

Опишите принципы построения системы и их разграничение или разбивку между базами данных.

*Пришлите блоксхему, где и что будет располагаться. Опишите, в каких режимах будут работать сервера.* 

План горизонтального и вертикального шардинга базы данных

Вертикальный шардинг (разделение по таблицам)
- БД Пользователи — в отдельной базе, т.к. может содержать чувствительные данные (логины, пароли, e-mail).
- БД Книги — отдельно, так как потенциально очень большая таблица с описаниями, жанрами, авторами.
- БД Магазины — отдельно, так как структура и нагрузка отличаются (геолокации, склады, остатки).

Таким образом, у нас будет 3 базы на разных серверах.

Горизонтальный шардинг (разделение внутри таблиц)
- Пользователи — можно делить по регионам (например, Россия, Европа, Азия) или по первой букве логина (А–М, Н–Я).
- Книги — по жанрам или по диапазону ID (например, ID 1–1 млн на сервере 1, 1 млн–2 млн на сервере 2).
- Магазины — по регионам (Москва/СПб/регионы, Европа/США/Азия).

⸻

Режимы работы серверов
- Для каждого шарда: один master (для записи) и несколько slave (для чтения, аналитики, резервирования).
- Таким образом, мы получаем систему, где:
- Master-сервера обрабатывают транзакции.
- Slave-сервера — балансируют нагрузку на чтение и обеспечивают отказоустойчивость.
```
                ┌──────────────┐
                │   Клиенты    │
                └──────┬───────┘
                       │
              ┌────────▼─────────┐
              │   Балансировщик  │
              └────────┬─────────┘
                       │
   ┌───────────────────┼───────────────────┐
   │                   │                   │
┌──▼──┐            ┌───▼───┐           ┌───▼───┐
│Users│            │ Books │           │Shops  │
└──┬──┘            └───┬───┘           └───┬───┘
   │                   │                   │
   │                   │                   │
┌──▼───┐           ┌───▼───┐           ┌───▼───┐
│Master│           │Master │           │Master │
└──┬───┘           └───┬───┘           └───┬───┘
   │                   │                   │
┌──▼───┐           ┌───▼───┐           ┌───▼───┐
│Slave │           │Slave  │           │Slave  │
└──────┘           └───────┘           └───────┘
```
## Дополнительные задания (со звёздочкой*)
Эти задания дополнительные, то есть не обязательные к выполнению, и никак не повлияют на получение вами зачёта по этому домашнему заданию. Вы можете их выполнить, если хотите глубже шире разобраться в материале.

---
### Задание 3*

Выполните настройку выбранных методов шардинга из задания 2.

*Пришлите конфиг Docker и SQL скрипт с командами для базы данных*.
